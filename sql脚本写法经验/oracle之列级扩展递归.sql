select * from MV_B001_ALL;

create materialized view MV_B001_ALL
    refresh force on demand
as
SELECT MIX_ORGID, ORGCODE, ORGNAME, ORGSHORTNAME, MIX_ORG_TREEID, COSTCENTERID, PAYCOMPANYCODE, PAYCOMPANYNAME, GZ_AREA,
       EMP_CYQ, B001010, B001005, B001255, EMP_SYB, A7_B001010, A7_B001005, A7_B001255,
       EMP_ZC, A6_B001010, A6_B001005, A6_B001255, EMP_GC, A5_B001010, A5_B001005, A5_B001255,
       EMP_BM, A4_B001010, A4_B001005, A4_B001255, EMP_KS, A3_B001010, A3_B001005, A3_B001255,
       EMP_GD, A25_B001010, A25_B001005, A25_B001255, EMP_BZ, A2_B001010, A2_B001005, A2_B001255,
       EMP_LA, A1_B001010, A1_B001005, A1_B001255 FROM V_B001_ALL;

create view V_B001_ALL as
SELECT A.ID MIX_ORGID
,A.B001010 ORGCODE
,A.B001005 ORGNAME
,A.B001255 ORGSHORTNAME
,A.B001003 MIX_ORG_TREEID
,A.B001205 COSTCENTERID
,T1.PAYCOMPANYCODE PAYCOMPANYCODE
,T1.PAYCOMPANYNAME PAYCOMPANYNAME
,A.B001214 GZ_AREA
,(SELECT ID FROM B001 B WHERE B.B001050 = '089520' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_CYQ
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '089520' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '089520' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID )B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '089520' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) B001255
,(SELECT ID FROM B001 B WHERE B.B001050 = '0895402210' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_SYB
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '0895402210' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A7_B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '0895402210' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A7_B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '0895402210' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A7_B001255
,(SELECT ID FROM B001 B WHERE B.B001050 = '089521' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_ZC
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '089521' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A6_B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '089521' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A6_B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '089521' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A6_B001255
,(SELECT ID FROM B001 B WHERE B.B001050 = '089550' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_GC
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '089550' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A5_B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '089550' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A5_B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '089550' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A5_B001255
,(SELECT ID FROM B001 B WHERE B.B001050 = '089599' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_BM
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '089599' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A4_B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '089599' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A4_B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '089599' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A4_B001255
,(SELECT ID FROM B001 B WHERE B.B001050 = '0895400307' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_KS
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '0895400307' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A3_B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '0895400307' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A3_B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '0895400307' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A3_B001255
--新增工段20250210 start
,(SELECT ID FROM B001 B WHERE B.B001050 = '0895438055' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_GD
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '0895438055' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A25_B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '0895438055' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A25_B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '0895438055' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A25_B001255
--新增工段20250210 end
,(SELECT ID FROM B001 B WHERE B.B001050 = '0895400306' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_BZ
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '0895400306' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A2_B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '0895400306' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A2_B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '0895400306' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A2_B001255
,(SELECT ID FROM B001 B WHERE B.B001050 = '0895400308' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) EMP_LA
,(SELECT B001010 FROM B001 B WHERE B.B001050 = '0895400308' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A1_B001010
,(SELECT B001005 FROM B001 B WHERE B.B001050 = '0895400308' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A1_B001005
,(SELECT B001255 FROM B001 B WHERE B.B001050 = '0895400308' AND ROWNUM =1 START WITH
B.ID = A.ID CONNECT BY PRIOR B.B001002 = B.ID ) A1_B001255
 FROM B001 A LEFT JOIN INTERFACE_COSTCENTER T1 ON A.B001205 = T1.COSTCENTERID;

